# поисковик на примере каталога флибусты

## термины и лицензии
* [флибуста](https://ru.wikipedia.org/wiki/%D0%A4%D0%BB%D0%B8%D0%B1%D1%83%D1%81%D1%82%D0%B0)
* каталог &mdash; архив списка книг (автор, название, год, ид), находится в открытом доступе
* данный проект не аффилирован с какими-либо торговыми марками, здесь упомянутыми
* файлы в каталоге /data/* не являются авторскими разработками и могут быть использованы без лицензии. Лицезию исходного файла данных (каталога) установить не удалось. Формальная лицензия проекта Unlicense License совместима с MIT, WTFPL, CC-BY

## проект
Проект выполнен в исследовательских и экспериментальных целях. Были выявлены ограничения гитхаба и других хранилищ (гитхаб 2000 секунд в месяц), установлено, что образы ubuntu* содержат кучу мусора (apache, bind, dot-net sdk, nodejs итд, а также предустановленный по зависимостям python3.8), проверены возможности SQLite (удобно расширять внешними пользовательскими функциями). Результаты экспериментов будут учтены в проектах @metaphonia и git-acts

## состав файлов
### в каталоге /data
* catalog.zip, catalog.txt &mdash; исходные файлы, внутренний формат похож на CSV с разделителем ```;```, но таковым не является, потому что поле №5 ```Subtitle``` может содержать несколько полей __с тем же разделителем__
* catalog.csv.txt &mdash; исправленный и подготовленный
* catalog.sqlite &mdash; бд с закачанными данными, структура: 
```sql 
create table if not exists 
catalog (surname varchar(255), name varchar(255), patronymic varchar(255), 
          title text, subtitle text, language char(2), year int, series text, id integer);
```
* catalog.csv &mdash; дамп в _правильном_ CSV
* catalog.sql.gz &mdash; дамп ANSI SQL

### /docs
* содержит демо https://ablaternae.github.io/flibusta-catalog-indexer/
* и проиндексированные данные в формате JSON ```/docs/i/``` 
### /scripts
* разные скрипты преобразования данных и вспомогательных функций

## todo
* [x] придумать морфологический поиск
* [x] проиндексировать содержимое
* [x] написать реализацию
* [ ] прикрутить веб-интерфейс
* [ ] статистика
* [ ] тг-бот

## немного статистики
* общее количество записей в первоначальной базе около полумиллиона и увеличивается
* размер исходных данных в текстовом виде более 70Мб
* SQL дамп 100Мб
* JSON дамп 120Мб
* общее количество слов длиннее двух символов более 10E6 (10 миллионов)
* размер поисковых файлов 21Мб (место на диске 2,2Гб для NTFS). учтите этот пункт, клонирование репозитория может приводить к неожиданным зависаниям
* скорость доступа стремится к нулю. точнее, сравнима с пропускной способностью канала и увеличивается линейно

## собрано при помощи
* bash
* awk
* SQLite
* PHP
* [zepto.js](//github.com/madrobby/zepto)
* [underscore.js](//github.com/jashkenas/underscore)
* [superkube](//github.com/imperavi/superkube)
* [CudaText](//github.com/Alexey-T/CudaText)

всем спасибо, проект завершён. если вы хотите на своем маленьком сайте быстрый поиск, свяжитесь со мной.
